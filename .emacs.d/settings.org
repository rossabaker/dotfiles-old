* Security

[[https://glyph.twistedmatrix.com/2015/11/editor-malware.html][Your Text Editor is Malware]]

#+BEGIN_SRC emacs-lisp
(let ((trustfile
       (replace-regexp-in-string
        "\\\\" "/"
        (replace-regexp-in-string
         "\n" ""
         (shell-command-to-string "python -m certifi")))))
  (setq tls-program
        (list
         (format "gnutls-cli%s --x509cafile %s -p %%p %%h"
                 (if (eq window-system 'w32) ".exe" "") trustfile))))
#+END_SRC

This will slow down startup, but make sure we got it right.

#+BEGIN_SRC emacs-lisp
(let ((bad-hosts
       (cl-loop for bad
             in `("https://wrong.host.badssl.com/"
                  "https://self-signed.badssl.com/")
             if (condition-case e
                    (url-retrieve
                     bad (lambda (retrieved) t))
                  (error nil))
             collect bad)))
  (if bad-hosts
      (error (format "tls misconfigured; retrieved %s ok"
                     bad-hosts))
    (url-retrieve "https://badssl.com"
                  (lambda (retrieved) t))))
#+END_SRC

* Bootstrap packages

#+BEGIN_SRC emacs-lisp
(unless (package-installed-p 'use-package)
  (package-refresh-contents)
  (package-install 'use-package))
(eval-when-compile
  (require 'use-package))
(require 'diminish)
(require 'bind-key)
#+END_SRC

Lack of ~:ensure t~ has bitten me twice after two ~use-package~
invocations. No more.

#+BEGIN_SRC emacs-lisp
(setq use-package-always-ensure t)
#+END_SRC

* Better defaults

A quick and minimal way to fix a bunch of default irritants.

#+BEGIN_SRC emacs-lisp
(use-package "better-defaults")
#+END_SRC

* Appearance

#+BEGIN_SRC emacs-lisp
(use-package "dracula-theme"
  :init
  (load-theme 'dracula t))
#+END_SRC

# Local Variables:
# org-src-preserve-indentation: t
# End:
